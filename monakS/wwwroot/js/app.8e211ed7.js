(function(e){function t(t){for(var a,o,s=t[0],c=t[1],l=t[2],p=0,d=[];p<s.length;p++)o=s[p],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&d.push(r[o][0]),r[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(d.length)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={app:0},i=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"199b":function(e,t,n){"use strict";n("6992")},"32b3":function(e,t,n){"use strict";n("5105")},"4e95":function(e,t,n){},5105:function(e,t,n){},5491:function(e,t,n){"use strict";n("7ff4")},"56d7":function(e,t,n){"use strict";n.r(t);n("b64b"),n("d3b7"),n("96cf");var a,r=n("1da1"),i=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("2b0e")),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{},[n("v-main",[n("router-view")],1)],1)},s=[],c=n("e87a"),l="ontouchstart"in document.documentElement;"undefined"!==typeof document.hidden?a="hidden":"undefined"!==typeof document.msHidden?a="msHidden":"undefined"!==typeof document.webkitHidden&&(a="webkitHidden");var u=!1,p=setInterval((function(){var e=document[a];e&&(console.log(document[a]),u=!0),u&&l&&!e&&(clearInterval(p),location.reload())}),300),d={name:"App",mounted:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("production"),console.log(e.SERVER_URL);case 2:case"end":return t.stop()}}),t)})))()},data:function(){return{}}},m=d,v=(n("034f"),n("2877")),f=n("6544"),h=n.n(f),b=n("7496"),g=n("f6c4"),w=Object(v["a"])(m,o,s,!1,null,null,null),y=w.exports;h()(w,{VApp:b["a"],VMain:g["a"]});var x=n("8c4f"),C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.layoutMode||null!=e.cameras&&0==e.cameras.length,expression:"layoutMode || (cameras != null && cameras.length == 0)"}],staticClass:"text-h6 text-center ma-10"},[n("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.$router.push("setup")}}},[e._v(" Add Camera "),n("v-icon",[e._v(" mdi-camera-plus ")])],1)],1),n("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},[n("v-card",[n("v-toolbar",{staticStyle:{position:"fixed","z-index":"1000"},attrs:{width:"100vw"}},[n("v-btn",{attrs:{icon:"",dark:""},on:{click:function(t){e.showDialog=!1}}},[n("v-icon",[e._v("mdi-close")])],1),n("v-toolbar-title",[e._v(" Captures ")]),n("v-spacer")],1),null!=e.dialogCam?n("CaptureOverview",{attrs:{cam:e.dialogCam}}):e._e()],1)],1),e._l(e.cameraLayout,(function(t,a){return n("div",{key:a},[e.layoutMode?n("v-btn",{staticStyle:{width:"100%"},on:{click:function(n){return e.moveUp(t)}}},[n("v-icon",[e._v("mdi-arrow-up-thick")])],1):e._e(),n("VideoPlayer",{directives:[{name:"hold",rawName:"v-hold.1500",value:function(){e.longPress(t)},expression:"\n        () => {\n          longPress(cam);\n        }\n      ",modifiers:{1500:!0}}],staticClass:"player",attrs:{cam:t,stream:e.streams[t.id]},on:{"show-files":function(n){return e.showFiles(t)},"show-settings":function(n){return e.showSettings(t)},playing:function(n){e.playing[t.id]=!0}}}),e.layoutMode?n("v-btn",{staticClass:"mb-5",staticStyle:{width:"100%"},on:{click:function(n){return e.moveDown(t)}}},[n("v-icon",[e._v("mdi-arrow-down-thick")])],1):e._e()],1)}))],2)},k=[],_=(n("4de4"),n("c975"),n("fb6a"),n("45fc"),n("a434"),n("3ca3"),n("ddb0"),n("b85c")),O=n("8785"),S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{position:"relative"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.overlay,expression:"overlay"}],staticClass:"headline font-weight-bold overlay",staticStyle:{top:"5%",left:"50%"}},[e._v(" "+e._s(e.cam.name)+" ")]),n("span",{directives:[{name:"show",rawName:"v-show",value:e.cam.isObjectDetectionEnabled,expression:"cam.isObjectDetectionEnabled"}],staticClass:"overlay",staticStyle:{top:"5%",right:"0px"}},[n("v-icon",{attrs:{color:"orange"}},[e._v("mdi-motion-sensor")])],1),n("DetectionCanvas",{attrs:{cam:e.cam}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.motionCaptureActive||e.timerCaptureActive||e.manualCaptureActive,expression:"motionCaptureActive || timerCaptureActive || manualCaptureActive"}],staticClass:"overlay",staticStyle:{top:"5%",right:"40px"}},[n("v-icon",{attrs:{color:e.manualCaptureActive?"red":"orange"}},[e._v("mdi-record-circle")])],1),n("v-btn",e._b({directives:[{name:"show",rawName:"v-show",value:e.overlay,expression:"overlay"}],staticStyle:{bottom:"20px"},attrs:{color:e.manualCaptureActive?"red":e.captureActive?"orange":"green",dark:"",fab:"",absolute:"",left:""},on:{click:function(t){return e.toggleCapture(e.cam)}}},"v-btn",e.btnSize,!1),[n("v-icon",[e._v("mdi-camera")])],1),n("v-btn",e._b({directives:[{name:"show",rawName:"v-show",value:e.overlay,expression:"overlay"}],staticStyle:{bottom:"20px",left:"90px"},attrs:{color:"primary",dark:"",fab:"",absolute:"",left:""},on:{click:function(t){return e.$emit("show-files")}}},"v-btn",e.btnSize,!1),[n("v-icon",[e._v("mdi-folder-search")])],1),n("v-btn",e._b({directives:[{name:"show",rawName:"v-show",value:e.overlay,expression:"overlay"}],staticStyle:{bottom:"20px","z-index":"100"},attrs:{color:"primary",dark:"",fab:"",absolute:"",right:""},on:{click:function(t){return e.$emit("show-settings")}}},"v-btn",e.btnSize,!1),[n("v-icon",[e._v("mdi-dots-horizontal")])],1),n("v-overlay",{directives:[{name:"hold",rawName:"v-hold.500",value:function(){e.isInteractive&&(e.overlay=!e.overlay)},expression:"\n      () => {\n        if (isInteractive) overlay = !overlay;\n      }\n    ",modifiers:{500:!0}}],attrs:{absolute:"",value:e.loading}},[n("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1),n("video",{directives:[{name:"hold",rawName:"v-hold.500",value:function(){e.isInteractive&&(e.overlay=!e.overlay)},expression:"\n      () => {\n        if (isInteractive) overlay = !overlay;\n      }\n    ",modifiers:{500:!0}}],ref:"player",attrs:{autoplay:"",muted:"",playsinline:""},domProps:{muted:!0,srcObject:e.stream},on:{loadeddata:e.playing}})],1)},R=[],j=(n("b0c0"),n("ade3")),T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{"pointer-events":"none"}},[n("div",{ref:"container",staticClass:"overlay"},[n("transition",{attrs:{name:"fade"}},[n("canvas",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],ref:"canvas",staticClass:"overlay"})])],1)])},D=[],E={name:"DetectionCanvas",props:{cam:Object},methods:{detectionResult:function(e){var t=this,n=e.cam,a=e.summary;if(n.id==this.cam.id){var r=this.$refs.canvas,i=this.$refs.container,o=r.getContext("2d");r.width=i.clientWidth,r.height=i.clientHeight,this.lastMsg=e,setTimeout((function(){t.lastMsg==e&&(t.visible=!1)}),4e3),o.clearRect(0,0,r.width,r.height),o.stroke();var s,c=a.detections.filter((function(e){return"person"==e.label})),l=Object(_["a"])(c);try{for(l.s();!(s=l.n()).done;){var u=s.value;console.log("detected");var p=r.width*u.left,d=r.height*u.top,m=r.width*u.right-p,v=r.height*u.bottom-d;o.lineWidth=4,o.strokeStyle="#E6007E",o.strokeRect(p,d,m,v),o.strokeStyle="black",o.fillStyle="#E6007E",o.font="bold 16px monospace",o.strokeText(u.label.toUpperCase(),p,d),o.fillText(u.label.toUpperCase(),p,d),o.stroke()}}catch(f){l.e(f)}finally{l.f()}this.visible=!0}}},mounted:function(){this.SIGNAL_R.on("OnDetectionResult",this.detectionResult)},beforeDestroy:function(){this.SIGNAL_R.off("OnDetectionResult",this.detectionResult)},data:function(){return{visible:!1,lastMsg:{}}}},V=E,P=(n("5491"),Object(v["a"])(V,T,D,!1,null,"01cef76e",null)),A=P.exports,N=n("9530"),$=n.n(N);function I(){var e=Object(O["a"])(["\n          subscription($id: Int!) {\n            onActiveCapturesChanged(\n              where: { isActive: { eq: true }, cam: { id: { eq: $id } } }\n            ) {\n              isActive\n              trigger\n              name\n              cam {\n                id\n              }\n            }\n          }\n        "]);return I=function(){return e},e}var M={name:"VideoPlayer",props:{stream:MediaStream,isInteractive:{default:!0,type:Boolean},cam:Object},components:{DetectionCanvas:A},apollo:{$subscribe:{onActiveCapturesChanged:{query:$()(I()),result:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.data,r=a.onActiveCapturesChanged,console.log(r),r){n.next=5;break}return n.abrupt("return");case 5:t.motionCaptureActive=r.some((function(e){return"MOTION"==e.trigger})),t.manualCaptureActive=r.some((function(e){return"MANUAL"==e.trigger})),t.timerCaptureActive=r.some((function(e){return"TIMER"==e.trigger}));case 8:case"end":return n.stop()}}),n)})))()},variables:function(){return{id:this.cam.id}}}}},computed:{btnSize:function(){var e={xs:"default",sm:"default",lg:"large",xl:"x-large"}[this.$vuetify.breakpoint.name];return e?Object(j["a"])({},e,!0):{}},captureActive:function(){return this.motionCaptureActive||this.timerCaptureActive||this.manualCaptureActive}},methods:{playing:function(){this.$emit("playing"),this.loading=!1},toggleCapture:function(){this.manualCaptureActive?this.SIGNAL_R.invoke("stopCapture",this.cam):this.SIGNAL_R.invoke("startCapture",this.cam)}},data:function(){return{loading:!0,overlay:!1,motionCaptureActive:!1,manualCaptureActive:!1,timerCaptureActive:!1}}},U=M,L=(n("d024"),n("8336")),B=n("132d"),H=n("a797"),q=n("490a"),z=Object(v["a"])(U,S,R,!1,null,"9b51b3fa",null),J=z.exports;h()(z,{VBtn:L["a"],VIcon:B["a"],VOverlay:H["a"],VProgressCircular:q["a"]});var W=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("video",{ref:"player",staticClass:"mt-5",attrs:{playsinline:"",muted:""},domProps:{muted:!0},on:{stalled:e.stop,ended:e.stop,progress:e.progress}}),n("div",{staticClass:"captureList"},[n("v-row",{directives:[{name:"show",rawName:"v-show",value:0==e.captures.length,expression:"captures.length == 0"}],staticClass:"mt-2",staticStyle:{height:"40px"},attrs:{align:"center",justify:"center"}},[n("div",{staticClass:"text-h6 text-center"},[e._v(" Captured camera footage will be listed here. ")])]),n("v-list",{attrs:{"three-line":""}},[e._l(e.captures,(function(t,a){return[n("div",{key:a},[n("v-divider"),n("v-list-item",[n("v-btn",{staticClass:"mr-5",attrs:{color:"primary"},on:{click:function(n){return e.play(t)}}},[e.active!=t?n("v-icon",[e._v("mdi-play")]):e.active!=t||e.playing?n("v-icon",[e._v("mdi-pause")]):n("v-icon",[e._v("mdi-play-pause")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v(" "+e._s(new Date(t.start).toLocaleString())+" ( "+e._s(Math.round((new Date(t.end)-new Date(t.start))/1e3))+" s ) ")]),n("v-list-item-subtitle",[n("div",[e._v(" "+e._s(t.trigger)+" ")])])],1)],1)],1)]}))],2)],1)])},G=[];function F(){var e=Object(O["a"])(["\n          subscription($id: Int!) {\n            onActiveCapturesChanged(where: { cam: { id: { eq: $id } } }) {\n              isActive\n              trigger\n              name\n              start\n              end\n              cam {\n                id\n              }\n            }\n          }\n        "]);return F=function(){return e},e}var Y={name:"CaptureOverview",props:{cam:Object},apollo:{$subscribe:{onActiveCapturesChanged:{query:$()(F()),result:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=e.data,t.captures=a.onActiveCapturesChanged;case 2:case"end":return n.stop()}}),n)})))()},variables:function(){return{id:this.cam.id}}}}},computed:{},methods:{progress:function(e){console.log(e)},stop:function(e){this.active=null,this.playing=!1},play:function(e){var t=this.$refs.player,n=this.SERVER_URL+"captures/"+e.name;this.active!=e&&(t.src=n,this.active=e,this.activeSrc=n,this.playing=!1),this.playing?(t.pause(),this.playing=!1):(t.play(),this.playing=!0)}},data:function(){return{active:null,activeSrc:"",playing:!1,captures:[]}}},K=Y,Q=(n("df65"),n("ce7e")),X=n("8860"),Z=n("da13"),ee=n("5d23"),te=n("0fd9"),ne=Object(v["a"])(K,W,G,!1,null,"24e8e75e",null),ae=ne.exports;function re(){var e=Object(O["a"])(["\n          subscription {\n            onCamerasChanged {\n              name\n              id\n              isObjectDetectionEnabled\n              streamUrl\n              user\n            }\n          }\n        "]);return re=function(){return e},e}h()(ne,{VBtn:L["a"],VDivider:Q["a"],VIcon:B["a"],VList:X["a"],VListItem:Z["a"],VListItemContent:ee["a"],VListItemSubtitle:ee["b"],VListItemTitle:ee["c"],VRow:te["a"]});var ie={name:"Home",components:{VideoPlayer:J,CaptureOverview:ae},apollo:{$subscribe:{onCamerasChanged:{query:$()(re()),result:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a,i,o,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=e.data,t.cameras=a.onCamerasChanged,t.streams=[],i=Object(_["a"])(t.cameras),n.prev=4,s=regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=o.value,e.next=3,t.WEBRTC_CONNECT(n);case 3:a=e.sent,"safari"==t.ADAPTER.browserDetails.browser?t.$nextTick(Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:setTimeout(Object(r["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.sleep(5e3);case 2:if(t.playing[n.id]){e.next=10;break}return e.next=5,t.WEBRTC_CONNECT(n);case 5:return a=e.sent,console.log("RETRY: "+n.id),e.next=9,t.sleep(100);case 9:t.$set(t.streams,n.id,a);case 10:return e.next=12,t.sleep(5e3);case 12:if(t.playing[n.id]){e.next=20;break}return e.next=15,t.WEBRTC_CONNECT(n);case 15:return r=e.sent,console.log("RETRY: "+n.id),e.next=19,t.sleep(100);case 19:t.$set(t.streams,n.id,r);case 20:case"end":return e.stop()}}),e)}))),5+t.getRandomInt(500));case 1:case"end":return e.stop()}}),e)})))):t.$set(t.streams,n.id,a);case 5:case"end":return e.stop()}}),e)})),i.s();case 7:if((o=i.n()).done){n.next=11;break}return n.delegateYield(s(),"t0",9);case 9:n.next=7;break;case 11:n.next=16;break;case 13:n.prev=13,n.t1=n["catch"](4),i.e(n.t1);case 16:return n.prev=16,i.f(),n.finish(16);case 19:case"end":return n.stop()}}),n,null,[[4,13,16,19]])})))()}}}},computed:{cameraLayout:function(){var e=this;if(null==this.layout)return this.cameras;if(null!=this.cameras){var t,n=Object(_["a"])(this.cameras);try{var a=function(){var n=t.value;e.layout.some((function(e){return e.id==n.id}))||e.layout.push(n)};for(n.s();!(t=n.n()).done;)a()}catch(r){n.e(r)}finally{n.f()}this.layout=this.layout.filter((function(t){return e.cameras.some((function(e){return e.id==t.id}))}))}return this.layout}},mounted:function(){var e=localStorage.getItem("layout");null!=e&&(this.layout=JSON.parse(e))},methods:{moveUp:function(e){var t=this.cameraLayout.slice(),n=t.indexOf(e);t.splice(n,1),t.splice(n-1,0,e),this.layout=t,localStorage.setItem("layout",JSON.stringify(this.layout))},moveDown:function(e){var t=this.cameraLayout.slice(),n=t.indexOf(e);t.splice(n,1),t.splice(n+1,0,e),this.layout=t,localStorage.setItem("layout",JSON.stringify(this.layout))},longPress:function(e){this.layoutMode=!this.layoutMode},getRandomInt:function(e){return Math.floor(Math.random()*Math.floor(e))},sleep:function(e){return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){return setTimeout(t,e)})));case 1:case"end":return t.stop()}}),t)})))()},showFiles:function(e){this.dialogCam=e,this.showDialog=!0},showSettings:function(e){this.$router.push({name:"Setup",params:{cam:e}})}},data:function(){return{layout:null,layoutMode:!1,showDialog:!1,dialogCam:null,streams:[],cameras:null,playing:[]}}},oe=ie,se=(n("199b"),n("b0af")),ce=n("169a"),le=n("2fa4"),ue=n("71d9"),pe=n("2a7f"),de=Object(v["a"])(oe,C,k,!1,null,"0f5ad1cc",null),me=de.exports;h()(de,{VBtn:L["a"],VCard:se["a"],VDialog:ce["a"],VIcon:B["a"],VSpacer:le["a"],VToolbar:ue["a"],VToolbarTitle:pe["a"]});var ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"setup"},[n("v-container",[n("v-stepper",{model:{value:e.stepper,callback:function(t){e.stepper=t},expression:"stepper"}},[n("v-stepper-header",[n("v-stepper-step",{attrs:{step:"1"}}),n("v-divider"),n("v-stepper-step",{attrs:{step:"2"}}),n("v-divider"),n("v-stepper-step",{attrs:{step:"3"}})],1),n("v-stepper-items",[n("v-stepper-content",{attrs:{step:"1"}},[n("v-tooltip",{attrs:{top:"","open-on-hover":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-row",{attrs:{align:"center",justify:"center"}},[n("div",{staticClass:"text-h6 text-center"},[e._v("Add Camera")]),n("v-btn",{attrs:{text:"","retain-focus-on-click":""},on:{click:a.click,blur:a.blur}},[n("v-icon",[e._v("mdi-help-circle-outline")])],1)],1)]}}])},[n("span",[e._v(" Enter a name and a "),n("u",[e._v("valid")]),e._v(" rtsp stream url. "),n("br"),e._v(" For a lot of models you can find settings "),n("a",{attrs:{href:"https://www.ispyconnect.com/sources.aspx"}},[e._v("here")]),e._v(". ")])]),n("v-text-field",{attrs:{label:"Name",placeholder:"Garage"},model:{value:e.camName,callback:function(t){e.camName=t},expression:"camName"}}),n("v-text-field",{attrs:{label:"Stream",placeholder:"rtsp://192.168.0.1:554/stream"},model:{value:e.camStream,callback:function(t){e.camStream=t},expression:"camStream"}}),n("v-switch",{attrs:{"prepend-icon":"mdi-lock"},model:{value:e.useCredentials,callback:function(t){e.useCredentials=t},expression:"useCredentials"}}),n("v-text-field",{directives:[{name:"show",rawName:"v-show",value:e.useCredentials,expression:"useCredentials"}],attrs:{label:"User"},model:{value:e.camUser,callback:function(t){e.camUser=t},expression:"camUser"}}),n("v-text-field",{directives:[{name:"show",rawName:"v-show",value:e.useCredentials,expression:"useCredentials"}],attrs:{"append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",type:e.showPassword?"text":"password",label:"Password",counter:""},on:{"click:append":function(t){e.showPassword=!e.showPassword}},model:{value:e.camPassword,callback:function(t){e.camPassword=t},expression:"camPassword"}}),n("v-btn",{staticClass:"mt-8 mr-4",attrs:{color:e.error?"red":"green",loading:e.loading,disabled:e.loading},domProps:{textContent:e._s(e.updateMode?"Update":"Add")},on:{click:function(t){e.updateMode?e.updateCamera():e.addCamera()}}}),n("v-btn",{staticClass:"mt-8",attrs:{disabled:e.loading},on:{click:e.cancel}},[e._v(" Cancel ")]),e.updateMode?n("v-btn",{staticClass:"mt-8",attrs:{absolute:"",right:"",color:"red",loading:e.loading},on:{click:e.removeCam}},[e._v(" Delete ")]):e._e()],1),n("v-stepper-content",{attrs:{step:"2"}},[n("v-tooltip",{attrs:{top:"","open-on-hover":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-row",{attrs:{align:"center",justify:"center"}},[n("div",{staticClass:"text-h6 text-center"},[e._v("Object Detection")]),n("v-btn",{attrs:{text:"","retain-focus-on-click":""},on:{click:a.click,blur:a.blur}},[n("v-icon",[e._v("mdi-help-circle-outline")])],1)],1)]}}])},[n("span",[e._v(" Enable or disable Object Detection. "),n("br"),e._v(" It is trained for detecting people. "),n("br"),e._v(" Be aware this will result in increased CPU usage. ")])]),e.shouldPlay&&null!=e.cam?n("VideoPlayer",{attrs:{cam:e.cam,stream:e.stream,isInteractive:!1},on:{playing:e.playing}}):e._e(),n("v-switch",{attrs:{"prepend-icon":e.enableObjectDetection?"mdi-motion-sensor":"mdi-motion-sensor-off"},on:{click:function(t){return e.updateCamera()}},model:{value:e.enableObjectDetection,callback:function(t){e.enableObjectDetection=t},expression:"enableObjectDetection"}}),n("v-expansion-panels",{directives:[{name:"show",rawName:"v-show",value:e.enableObjectDetection,expression:"enableObjectDetection"}]},[n("v-expansion-panel",[n("v-expansion-panel-header",[e._v("Advanced")]),n("v-expansion-panel-content",[n("v-switch",{attrs:{"prepend-icon":"mdi-record-rec"},model:{value:e.enableObjectDetectionRec,callback:function(t){e.enableObjectDetectionRec=t},expression:"enableObjectDetectionRec"}}),n("v-text-field",{attrs:{label:"Duration (s)",type:"number","prepend-icon":"mdi-clock-start"},model:{value:e.objectDetectionRecDuration,callback:function(t){e.objectDetectionRecDuration=t},expression:"objectDetectionRecDuration"}}),n("v-text-field",{attrs:{placeholder:"10s",label:"Timehsift (s)","prepend-icon":"mdi-autorenew"},model:{value:e.objectDetectionRecBufferDuration,callback:function(t){e.objectDetectionRecBufferDuration=t},expression:"objectDetectionRecBufferDuration"}})],1)],1)],1),n("v-btn",{staticClass:"mt-8 mr-4",attrs:{color:"primary"},on:{click:function(t){e.stepper=3}}},[e.motionSettingsUpdated?n("div",[e._v("Continue")]):n("div",[e._v("Skip")])]),n("v-btn",{staticClass:"mt-8",on:{click:e.cancel}},[e._v(" Cancel ")])],1),n("v-stepper-content",{attrs:{step:"3"}},[n("v-tooltip",{attrs:{top:"","open-on-hover":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-row",{attrs:{align:"center",justify:"center"}},[n("div",{staticClass:"text-h6 text-center"},[e._v("Timer")]),n("v-btn",{attrs:{text:"","retain-focus-on-click":""},on:{click:a.click,blur:a.blur}},[n("v-icon",[e._v("mdi-help-circle-outline")])],1)],1)]}}])},[n("span",[e._v(" Capture footage every day at a specific time interval. ")])]),n("v-switch",{attrs:{"prepend-icon":"mdi-clock-outline"},model:{value:e.useTimer,callback:function(t){e.useTimer=t},expression:"useTimer"}}),e.useTimer?n("v-dialog",{ref:"dialog1",attrs:{"return-value":e.startTime,persistent:"",width:"290px"},on:{"update:returnValue":function(t){e.startTime=t},"update:return-value":function(t){e.startTime=t}},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({attrs:{label:"Start","prepend-icon":"mdi-clock-start",readonly:""},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}},"v-text-field",r,!1),a))]}}],null,!1,3841312212),model:{value:e.dialogStartTime,callback:function(t){e.dialogStartTime=t},expression:"dialogStartTime"}},[e.dialogStartTime?n("v-time-picker",{attrs:{format:"24hr",scrollable:"","full-width":""},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}},[n("v-spacer"),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.dialogStartTime=!1}}},[e._v(" Cancel ")]),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.dialog1.save(e.startTime)}}},[e._v(" OK ")])],1):e._e()],1):e._e(),e.useTimer?n("v-dialog",{ref:"dialog2",attrs:{"return-value":e.stopTime,persistent:"",width:"290px"},on:{"update:returnValue":function(t){e.stopTime=t},"update:return-value":function(t){e.stopTime=t}},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({attrs:{label:"Stop","prepend-icon":"mdi-clock-end",readonly:""},model:{value:e.stopTime,callback:function(t){e.stopTime=t},expression:"stopTime"}},"v-text-field",r,!1),a))]}}],null,!1,775256475),model:{value:e.dialogStopTime,callback:function(t){e.dialogStopTime=t},expression:"dialogStopTime"}},[e.dialogStopTime?n("v-time-picker",{attrs:{format:"24hr",scrollable:"","full-width":""},model:{value:e.stopTime,callback:function(t){e.stopTime=t},expression:"stopTime"}},[n("v-spacer"),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.dialogStopTime=!1}}},[e._v(" Cancel ")]),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.dialog2.save(e.stopTime)}}},[e._v(" OK ")])],1):e._e()],1):e._e(),n("v-btn",{staticClass:"mt-8 mr-4",attrs:{color:"green"},on:{click:function(t){return e.$router.push("/")}}},[e._v(" Finish ")]),n("v-btn",{staticClass:"mt-8",on:{click:e.cancel}},[e._v(" Cancel ")])],1)],1)],1)],1)],1)},fe=[],he={name:"Setup",components:{VideoPlayer:J},methods:{playing:function(){this.stepper=2,this.loading=!1},removeCam:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:null!=e.cam&&e.updateMode&&confirm("Ok ?")&&(fetch(e.SERVER_URL+"camera",{method:"DELETE",body:JSON.stringify(e.cam),headers:{"Content-Type":"application/json"}}),e.$router.push("/"));case 1:case"end":return t.stop()}}),t)})))()},cancel:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.updateMode||e.removeCam(),e.$router.push("/");case 2:case"end":return t.stop()}}),t)})))()},updateCamera:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return 2==e.stepper?(e.cam.isObjectDetectionEnabled=e.enableObjectDetection,e.motionSettingsUpdated=!0):1==e.stepper&&(e.loading=!0),t.next=3,fetch(e.SERVER_URL+"camera/".concat(e.cam.id),{method:"PUT",body:JSON.stringify({id:e.cam.id,name:e.camName,streamUrl:e.camStream,user:e.camUser,password:e.camPassword,isObjectDetectionEnabled:e.enableObjectDetection}),headers:{"Content-Type":"application/json"}});case 3:if(n=t.sent,!n.ok||1!=e.stepper){t.next=16;break}return t.next=7,n.json();case 7:return a=t.sent,t.next=10,e.WEBRTC_CONNECT(a);case 10:e.stream=t.sent,e.cam=a,e.shouldPlay=!0,e.error=!1,t.next=17;break;case 16:e.error=!0;case 17:case"end":return t.stop()}}),t)})))()},addCamera:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,fetch(e.SERVER_URL+"camera",{method:"POST",body:JSON.stringify({name:e.camName,streamUrl:e.camStream,user:e.camUser,password:e.camPassword}),headers:{"Content-Type":"application/json"}});case 3:if(n=t.sent,!n.ok){t.next=16;break}return t.next=7,n.json();case 7:return a=t.sent,t.next=10,e.WEBRTC_CONNECT(a);case 10:e.stream=t.sent,e.cam=a,e.error=!1,e.shouldPlay=!0,t.next=18;break;case 16:e.loading=!1,e.error=!0;case 18:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this.$route.params.cam;void 0!=e&&(this.cam=e,this.camName=e.name,this.updateMode=!0,this.camStream=e.streamUrl,""!=this.cam.user&&(this.camUser=this.cam.user,this.useCredentials=!0))},data:function(){return{shouldPlay:!1,updateMode:!1,motionSettingsUpdated:!1,dialogStartTime:!1,dialogStopTime:!1,startTime:null,stopTime:null,useTimer:!1,cam:null,error:!1,loading:!1,showPassword:!1,useCredentials:!1,enableObjectDetection:!1,enableObjectDetectionRec:!0,objectDetectionRecDuration:30,objectDetectionRecBufferDuration:10,camPassword:"",camUser:"",camName:"",camStream:"",stepper:1,stream:null}}},be=he,ge=(n("32b3"),n("a523")),we=n("cd55"),ye=n("49e2"),xe=n("c865"),Ce=n("0393"),ke=n("7e85"),_e=n("e516"),Oe=n("9c54"),Se=n("56a4"),Re=n("b73d"),je=n("8654"),Te=n("c964"),De=n("3a2f"),Ee=Object(v["a"])(be,ve,fe,!1,null,"19bd081a",null),Ve=Ee.exports;h()(Ee,{VBtn:L["a"],VContainer:ge["a"],VDialog:ce["a"],VDivider:Q["a"],VExpansionPanel:we["a"],VExpansionPanelContent:ye["a"],VExpansionPanelHeader:xe["a"],VExpansionPanels:Ce["a"],VIcon:B["a"],VRow:te["a"],VSpacer:le["a"],VStepper:ke["a"],VStepperContent:_e["a"],VStepperHeader:Oe["a"],VStepperItems:Oe["b"],VStepperStep:Se["a"],VSwitch:Re["a"],VTextField:je["a"],VTimePicker:Te["a"],VTooltip:De["a"]}),i["a"].use(x["a"]);var Pe=[{path:"/",name:"Home",component:me},{path:"/setup",name:"Setup",component:Ve}],Ae=new x["a"]({routes:Pe}),Ne=Ae,$e=n("f309");i["a"].use($e["a"]);var Ie=new $e["a"]({theme:{dark:!0}}),Me=n("d093"),Ue=(n("99af"),n("5530")),Le=n("522d"),Be=n("efe7");i["a"].use(Le["a"]);var He="apollo-token",qe=window.location.hostname,ze=window.location.port,Je="".concat(qe,":").concat(ze,"/"),We="http://"+Je+"graphql",Ge="ws://"+Je+"graphql",Fe=We,Ye={httpEndpoint:Fe,wsEndpoint:Ge,tokenName:He,persisting:!1,websocketsOnly:!1,ssr:!1};function Ke(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(Be["createApolloClient"])(Object(Ue["a"])(Object(Ue["a"])({},Ye),e)),n=t.apolloClient,a=t.wsClient;n.wsClient=a;var r=new Le["a"]({defaultClient:n,defaultOptions:{$query:{}},errorHandler:function(e){console.log("%cError","background: red; color: white; padding: 2px 4px; border-radius: 3px; font-weight: bold;",e.message)}});return r}i["a"].config.productionTip=!1;var Qe="/";i["a"].prototype.SERVER_URL=Qe;var Xe=(new c["a"]).withUrl(Qe+"msg").build();function Ze(){return et.apply(this,arguments)}function et(){return et=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Xe.stop();case 2:return e.next=4,Xe.start();case 4:new i["a"]({router:Ne,vuetify:Ie,apolloProvider:Ke(),render:function(e){return e(y)}}).$mount("#app");case 5:case"end":return e.stop()}}),e)}))),et.apply(this,arguments)}i["a"].prototype.SIGNAL_R=Xe,i["a"].prototype.ADAPTER=Me["a"],i["a"].prototype.WEBRTC_CONNECT=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(n,a){var i,o,s,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=new RTCPeerConnection,i.ontrack=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.track.onunmute=function(){var e=t.streams[0];n(e)};case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.onicecandidate=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.candidate){e.next=3;break}return e.next=3,Xe.invoke("setCandidate",o,t.candidate);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=5,Xe.invoke("getSessionId",t);case 5:return o=e.sent,e.next=8,Xe.invoke("getOffer",o);case 8:return s=e.sent,e.next=11,i.setRemoteDescription({type:"offer",sdp:s});case 11:return e.next=13,i.createAnswer();case 13:return c=e.sent,e.next=16,i.setLocalDescription(c);case 16:return l=i.localDescription.sdp,e.next=19,Xe.invoke("setAnswer",o,l);case 19:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i["a"].directive("hold",{bind:function(e,t){if("function"===typeof t.value){var n=t.modifiers?Object.keys(t.modifiers)[0]:500,a=new Hammer.Manager(e),r=new Hammer.Press({time:n});a.add(r),a.on("press",t.value)}}}),Ze()},6992:function(e,t,n){},"7ff4":function(e,t,n){},"85ec":function(e,t,n){},8955:function(e,t,n){},d024:function(e,t,n){"use strict";n("4e95")},df65:function(e,t,n){"use strict";n("8955")}});
//# sourceMappingURL=app.8e211ed7.js.map